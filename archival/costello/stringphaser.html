<HTML>
<HEAD>
<TITLE>stringphaser</TITLE> 
</HEAD><BODY TEXT="#000000" BGCOLOR="#ffffff"><FONT FACE="Arial, Helvetica">
<IMG SRC="portfolio.gif" BORDER=0 USEMAP="#portfolio">
<MAP NAME="portfolio">
<AREA SHAPE="RECT" ALT="portfolio" COORDS="23,1,152,34" HREF="portfolio.html">
<AREA SHAPE="RECT" ALT="resume" COORDS="164,0,278,33" HREF="resume.html">
<AREA SHAPE="RECT" ALT="links" COORDS="289,1,379,31" HREF="links.html">
<AREA SHAPE="RECT" ALT="home" COORDS="391,1,488,32" HREF="index.html">
<AREA SHAPE="DEFAULT" NOHREF>
</MAP>
<P>
<H1>stringphaser</H1>
<P>
<B><A HREF="http://www.haint.com/sounds/stringphaser.mp3">stringphaser.mp3</A></B> (128 kbps, 376 KB)<BR>
<A HREF="stringphaser.orc">stringphaser.orc</A><BR>
<A HREF="stringphaser.sco">stringphaser.sco</A><P>
<H2>Inspiration</H2>
<P><B>stringphaser</B> is a digital recreation of the classic "string ensemble through a phase shifter" combination that was common during the 1970's and early 1980's. A string ensemble was an attempt to produce a reasonably full string orchestra sound, with full polyphony, using the "divide-down" organ technology of the day.  Keyboards such as the Eminent Solina, ARP String Ensemble, Moog Opus 3, and Crumar Performer were used to provide the high string lines for such artists as Jean-Michel Jarre, Funkadelic, Gary Wright, the Cure, Duran Duran, and countless other musicians. Phase shifters such as the Electro-Harmonix Small Stone, the Mutron Bi-Phase, and the Moog 12-Stage Phaser were used to contribute a "swirling" sweep to the sound that was markedly different from the flangers that were just coming on to the market at that time. 
<P>
<H2>Technical Overview</H2>
<P>
Although the string ensembles used rather primitive circuitry compared to the polyphonic synthesizers such as the Prophet 5 that would emerge just a few years later, they managed to generate a very thick sound with far less circuitry than a fully polyphonic, multi-oscillator synthesizer would require. A synthesizer such as the Minimoog or Prophet 5 uses multiple oscillators per each note to generate an animated sound; this yields excellent results, but requires a large number of oscillators for reasonable levels of polyphony.  In contrast, most string ensembles used a single sawtooth wave for each note, derived from a "divide-down" network driven by a single high-frequency oscillator. These sawtooth waves were then processed by a global effects processor, consisting of 3 bucket brigade delay lines (BBD) driven by 2 multiphase low frequency oscillators. 
<P>
I decided to emulate this structure, using bandwidth-limited pulse waveforms for each "sawtooth" note, and running all of the notes through a single global effects unit, with 3 parallel delay lines with interpolating taps providing the "chorusing effect." My initial model was the service manual for the Moog Opus 3, although I also refered to the <A HREF="http://users.bart.nl/~brun/klm368.jpg">schematic</A> of the Korg Polysix ensemble submodule while creating this orchestra.
<UL>
<LI><B>instr 19</B> produces the raw sawtooth waveforms for each note. The "sawtooth" waves are generated using <B>gbuzz</B>, with a high harmonic scaling factor (.9). 
<LI>The output of the <B>gbuzz</B> generator is multiplied by a simple <B>linseg</B> envelope, to simulate the simple AR-type envelopes used in most string ensembles.
</UL>
The output of each instance of <B>instr 19</B> is sent to <B>instr 22</B>, which is the global effects processor that produces the animated nature of the overall sound.
<UL>
<LI>The modulation for the delay lines of the chorus is generated by two 3-phase LFO's. Each LFO consists of 3 <B>oscili</B> ugens, using a sine table for vibrato, with the output of each <B>oscili</B> staggered in phase by 120 degrees. One 3-phase LFO generates a signal at a vibrato rate (5.5 Hz), while the other LFO generates a slower signal (.43 Hz).
<LI>The outputs of each LFO are scaled, so that the slower LFO has an amplitude 4 times greater than the faster LFO. The scaled outputs of the 2 LFOs are summed, so that the corresponding phase outputs are summed with each other - i.e. the 0 degree output of the .43 Hz <B>oscili</B> is summed with the 0 degree output of the 5.5 Hz <B>oscili</B>, the 1200 degree output of the .43 Hz <B>oscili</B> is summed with the 120 degree output of the 5.5 Hz <B>oscili</B>, and the 240 degree output of the .43 Hz <B>oscili</B> is summed with the 240 degree output of the 5.5 Hz <B>oscili</B>.
<LI>The scaled and summed modulation signals are then used to modulate the delay lengths of three <B>deltapi</B> lines, which have the global outputs of all <B>instr 19</B> instances as their input. The amount of modulation is adjusted by ear, by listening to the output of a single delay line. The delay line's output should have a nice amount of pitch vibrato, without being excessive, with a very small amount of pitch undulation from the slower LFO.
<LI>The outputs of the three delay lines are summed together. None of the non-delayed signal is mixed in (as opposed to a standard chorus/flanger, in which the original signal is mixed in with the delayed outputs). The result is a highly animated sound, with complex pitch and timbral sweeps.
</UL>
The "ensemble" sound produced by the parallel delay lines is then processed by a 6 allpass filters in series, with swept coefficients, to produce the characteristic "phase shifting" sound. My original orchestr used my <A HREF="allpassn.html">allpassn</A> ugen, which works on a similar principle as the allpass filters in <B>stringphaser</B>. <B>allpassn</B> has some advantages in this application, as <B>allpassn</B> allows for much higher numbers of allpass stages, and does not require the control rate to equal the sampling rate, which is necessary when constructing filters from scratch in a Csound orchestra.
<UL>
<LI>Each allpass stage is of the form y(n) = C * x(n) + x(n-1) - C * y(n-1), where x(n) is the input, x(n-1) is the previous input sample, y(n) is the output, y(n-1) is the previous output sample, and C is the allpass coefficient, which must be in the range -1 < C < 1.
<LI>The coefficient C is generated by an <B>oscili</B> ugen which uses an inverted half sine wave as its wavetable. This produces a unipolar moduation signal (ranging between -1 and 0) that works well at producing a smooth "sweeping" sound.
<LI>The output of the allpass series is summed with its input, to produce the "phase shifting" sound. This sound is characterized by several notches (in this case, 3) sweeping up and down the spectrum. As these notches are not harmonically related, the resultant sound is markedly different from conventional flanging.
<LI>A portion of the output of the allpass series is fed back into the input, to produce a more "resonant" notch filtering sound.
</UL>
The outputs of the allpass filtered ensemble sound are sent to the main outputs. In addition, part of the output is sent to <B>instr 99</B>, a global reverberator based on the Feedback Delay Network (FDN) reverberator described in <A HREF=#Stautner>[Stautner and Puckette 1982]</A>. The reverb works well with the ensemble/phaser combination, in producing a very thick, rich sound out of simple source material.
<P>
<H2>References</H2> 
<A NAME="Stautner">Stautner, John and Puckette, Miller. "Designing Multi-Channel Reverberators." <I>Computer Music Journal</I>, Vol. 6, No 1, Spring 1982.</A>
<P>
<HR>
<P>
<I>Questions? Comments? Email me at <A HREF="mailto:costello@seanet.com">costello@seanet.com</A>.
<P>
</BODY>
</HTML>
